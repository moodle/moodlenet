import { ListCard, TertiaryButton } from '@moodlenet/component-library'
import type { BrowserMainColumnItemBase, ProxyProps } from '@moodlenet/react-app/ui'
import type { FC } from 'react'
import { useMemo } from 'react'
import type { ProfileCardProps } from '../../ProfileCard/ProfileCard'
import { ProfileCard } from '../../ProfileCard/ProfileCard'
import './BrowserProfileList.scss'

export type BrowserProfileListDataProps = {
  profilesCardPropsList: { props: ProxyProps<ProfileCardProps>; key: string }[]
  loadMore: (() => unknown) | null
}
export type BrowserProfileListProps = BrowserProfileListDataProps & BrowserMainColumnItemBase
export const BrowserProfileList: FC<BrowserProfileListProps> = ({
  profilesCardPropsList,
  showAll,
  setShowAll,
  loadMore,
  showHeader,
}) => {
  const listCard = (
    <ListCard
      noCard={showAll && !showHeader}
      className={`browser-profile-list ${showAll ? 'show-all' : ''}  ${
        loadMore ? 'load-more' : ''
      }`}
      content={useMemo(
        () =>
          profilesCardPropsList
            // .slice(0, 11)
            .map(({ props, key }) => {
              return { key, el: <ProfileCard key={key} {...props} /> }
            }),
        [profilesCardPropsList],
      )}
      header={
        showHeader && (
          <div className="card-header">
            <div className="title">
              People
              {/* {peopleTitle ? peopleTitle : People} */}
            </div>

            {/* {!seeAll && ( */}
            {
              // <SecondaryButton
              //   // onClick={() => activateSeeAll('People')}
              //   color="dark-blue"
              // >
              //   See all
              // </SecondaryButton>
            }
          </div>
        )
      }
      footer={
        showAll ? (
          loadMore ? (
            <TertiaryButton onClick={loadMore}>Load more</TertiaryButton>
          ) : null
        ) : (
          <TertiaryButton onClick={setShowAll}>See all people results</TertiaryButton>
        )
      }
      minGrid={170}
      maxRows={showAll ? undefined : 2}
    />
  )

  return profilesCardPropsList.length > 0 ? listCard : null
}

BrowserProfileList.defaultProps = { showHeader: true }

export default BrowserProfileList
